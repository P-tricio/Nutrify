import{r as e,a,R as s}from"./react-VIHZQHJq.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();var r={exports:{}},t={},l=e,n=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function m(e,a,s){var r,t={},l=null,i=null;for(r in void 0!==s&&(l=""+s),void 0!==a.key&&(l=""+a.key),void 0!==a.ref&&(i=a.ref),a)o.call(a,r)&&!d.hasOwnProperty(r)&&(t[r]=a[r]);if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===t[r]&&(t[r]=a[r]);return{$$typeof:n,type:e,key:l,ref:i,props:t,_owner:c.current}}t.Fragment=i,t.jsx=m,t.jsxs=m,r.exports=t;var u,x=r.exports,p=a;u=p.createRoot,p.hydrateRoot;const h=()=>{const[a,s]=e.useState(""),[r,t]=e.useState(0),l=["Calculando las proporciones ideales de macronutrientes...","Seleccionando los ingredientes más frescos...","Diseñando un menú equilibrado y delicioso...","Ajustando las cantidades según tus necesidades...","Preparando sugerencias de preparación paso a paso..."];return e.useEffect((()=>{const e=setInterval((()=>{s((e=>e.length>=3?"":e+"."))}),500);return()=>clearInterval(e)}),[]),e.useEffect((()=>{const e=setInterval((()=>{t((e=>(e+1)%l.length))}),3e3);return()=>clearInterval(e)}),[l.length]),x.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[x.jsx("div",{className:"w-full max-w-md mx-auto bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200",children:x.jsx("div",{className:"p-6",children:x.jsxs("div",{className:"flex flex-col items-center",children:[x.jsxs("div",{className:"relative w-20 h-20 mb-5",children:[x.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-primary-50 to-primary-100 opacity-75"}),x.jsx("div",{className:"absolute inset-1.5 border-4 border-t-primary-500 border-r-primary-400 border-b-primary-300 border-l-primary-400 rounded-full animate-spin"}),x.jsx("div",{className:"absolute inset-3 flex items-center justify-center",children:x.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),x.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Preparando tu plan"}),x.jsx("div",{className:"min-h-[60px] w-full flex items-center justify-center mb-4 px-4",children:x.jsx("p",{className:"text-gray-600 text-center text-base transition-opacity duration-500",children:l[r]})}),x.jsx("div",{className:"w-full max-w-xs bg-gray-100 rounded-full h-2 overflow-hidden mb-2",children:x.jsx("div",{className:"bg-gradient-to-r from-primary-400 to-primary-600 h-full rounded-full",style:{width:"70%",animation:"pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite"}})}),x.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Esto puede tomar unos segundos",a]})]})})}),x.jsx("style",{jsx:!0,global:!0,children:"\n        @keyframes pulse {\n          0%, 100% { opacity: 0.8; }\n          50% { opacity: 1; }\n        }\n      "})]})},g=({label:e,name:a,type:s="text",value:r,onChange:t,error:l,options:n=[],required:i=!1,min:o,max:c,step:d,className:m="",...u})=>x.jsxs("div",{className:`mb-4 ${m}`,children:[x.jsxs("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",i&&x.jsx("span",{className:"text-red-500",children:"*"})]}),"select"===s?x.jsxs("select",{id:a,name:a,value:r,onChange:t,className:`input-field ${l?"input-error":""} ${m}`,required:i,...u,children:[x.jsx("option",{value:"",children:"Selecciona una opción"}),n.map((e=>x.jsx("option",{value:e.value,children:e.label},e.value)))]}):"range"===s?x.jsxs("div",{className:"w-full",children:[x.jsxs("div",{className:"flex justify-between items-center mb-1",children:[x.jsx("span",{className:"text-sm font-medium text-neutral-700",children:e}),x.jsxs("span",{className:"text-sm font-semibold text-primary-600",children:[r,"%"]})]}),x.jsx("input",{type:"range",id:a,name:a,min:o||0,max:c||100,step:d||1,value:r,onChange:t,className:"w-full h-2 bg-neutral-200 rounded-lg appearance-none cursor-pointer accent-primary-600",...u})]}):"textarea"===s?x.jsx("textarea",{id:a,name:a,value:r,onChange:t,className:`input-field ${l?"input-error":""} ${m}`,required:i,rows:"3",...u}):x.jsx("input",{type:s,id:a,name:a,value:r,onChange:t,className:`input-field ${l?"input-error":""} ${m}`,required:i,min:o,max:c,step:d,...u}),l&&x.jsx("p",{className:"error-message",children:l})]}),f=({proteinPercentage:e,carbsPercentage:a,fatPercentage:s,calories:r,className:t=""})=>{const l=Math.round(r*(e/100)/4),n=Math.round(r*(a/100)/4),i=Math.round(r*(s/100)/9);return x.jsxs("div",{className:`bg-white p-4 rounded-lg shadow-md border-2 border-gray-200 ${t}`,children:[x.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Distribución de macronutrientes"}),x.jsxs("div",{className:"w-full bg-gray-100 rounded-full h-4 mb-6 overflow-hidden flex",children:[x.jsx("div",{className:"h-full bg-red-400 transition-all duration-300",style:{width:`${e}%`},title:`Proteínas: ${e}%`}),x.jsx("div",{className:"h-full bg-orange-300 transition-all duration-300",style:{width:`${a}%`},title:`Carbohidratos: ${a}%`}),x.jsx("div",{className:"h-full bg-yellow-400 transition-all duration-300",style:{width:`${s}%`},title:`Grasas: ${s}%`})]}),x.jsxs("div",{className:"space-y-3 max-w-xs mx-auto",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full mr-2"}),x.jsx("span",{className:"text-sm",children:"Proteínas"})]}),x.jsxs("span",{className:"text-sm font-medium",children:[e,"% • ",l,"g"]})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:"w-3 h-3 bg-orange-300 rounded-full mr-2"}),x.jsx("span",{className:"text-sm",children:"Carbohidratos"})]}),x.jsxs("span",{className:"text-sm font-medium",children:[a,"% • ",n,"g"]})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full mr-2"}),x.jsx("span",{className:"text-sm",children:"Grasas"})]}),x.jsxs("span",{className:"text-sm font-medium",children:[s,"% • ",i,"g"]})]})]})]})},b=({totalCalories:e,totalProteins:a,totalCarbs:s,totalFats:r,targetProtein:t,targetCarbs:l,targetFats:n})=>a||s||r?x.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md border-2 border-green-200",children:[x.jsx("h3",{className:"text-lg font-semibold mb-2 text-center",children:"Macronutrientes Generados"}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(v,{label:"Proteínas",value:a,target:t,color:"red-400",calories:e,kcalPerGram:4}),x.jsx(v,{label:"Carbohidratos",value:s,target:l,color:"orange-300",calories:e,kcalPerGram:4}),x.jsx(v,{label:"Grasas",value:r,target:n,color:"yellow-400",calories:e,kcalPerGram:9})]})]}):null,v=({label:e,value:a,target:s,color:r,calories:t,kcalPerGram:l})=>{const n=a-s,i=Math.abs(n)>5?"bg-red-100 text-red-700":"bg-green-100 text-green-700";return x.jsxs("div",{className:"mb-2",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:`w-3 h-3 bg-${r} rounded-full mr-2`}),x.jsxs("span",{children:[e,":"]})]}),x.jsxs("span",{className:"font-medium",children:[a,"% (",Math.round(t*(a/100)/l),"g)"]})]}),x.jsx("div",{className:"flex justify-end mt-1",children:x.jsxs("span",{className:`text-xs px-2 py-1 rounded ${i}`,children:[n>0?"+":"",n,"% vs objetivo"]})})]})},j={perdida:-.15,mantenimiento:0,aumento:.15},y=({onCalculate:a,selectedGoal:s="mantenimiento",goalOptions:r})=>{var t;const[l,n]=e.useState({gender:"male",age:"",weight:"",height:"",activityLevel:"1.2",goal:"0"}),[i,o]=e.useState(null),[c,d]=e.useState({}),[m,u]=e.useState(j[s]||0);e.useEffect((()=>{u(j[s]||0)}),[s]);const p=e=>{if(e&&"function"==typeof e.preventDefault&&e.preventDefault(),!(()=>{const e={};return(!l.age||l.age<15||l.age>100)&&(e.age="Edad debe estar entre 15 y 100 años"),(!l.weight||l.weight<30||l.weight>250)&&(e.weight="Peso debe estar entre 30kg y 250kg"),(!l.height||l.height<120||l.height>250)&&(e.height="Altura debe estar entre 120cm y 250cm"),d(e),0===Object.keys(e).length})())return console.log("Validación fallida"),!1;console.log("Datos del formulario:",l);const{gender:s,age:r,weight:t,height:n,activityLevel:i}=l,c=parseFloat(t),u=parseFloat(n),x=parseFloat(r);if(console.log("Valores numéricos procesados:",{weightNum:c,heightNum:u,ageNum:x}),isNaN(c)||isNaN(u)||isNaN(x))return void console.error("Valores inválidos para el cálculo");let p;p="male"===s?88.362+13.397*c+4.799*u-5.677*x:447.593+9.247*c+3.098*u-4.33*x;const h=p*parseFloat(i),g=100*Math.round(h*(1+m)/100);console.log("Cálculos intermedios:",{bmr:p,tdee:h,goalAdjustment:m,adjustedCalories:g});const f={bmr:Math.round(p),tdee:Math.round(h),adjustedCalories:g,goal:100*m};if(o(f),console.log("Llamando a onCalculate con:",g),"function"==typeof a)a(g);else{console.warn("onCalculate no es una función, pero continuando con el valor:",g);const e=document.querySelector('input[name="calories"]');if(e){e.value=g;const a=new Event("input",{bubbles:!0});e.dispatchEvent(a),console.log("Campo de calorías actualizado manualmente")}}},h=e=>{const{name:a,value:s}=e.target;n((e=>({...e,[a]:s})))};return x.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[x.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Calculadora de calorías diarias"}),x.jsxs("form",{onSubmit:p,className:"space-y-4",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Género"}),x.jsxs("div",{className:"flex space-x-4",children:[x.jsxs("label",{className:"inline-flex items-center",children:[x.jsx("input",{type:"radio",name:"gender",value:"male",checked:"male"===l.gender,onChange:h,className:"text-primary-600"}),x.jsx("span",{className:"ml-2",children:"Hombre"})]}),x.jsxs("label",{className:"inline-flex items-center",children:[x.jsx("input",{type:"radio",name:"gender",value:"female",checked:"female"===l.gender,onChange:h,className:"text-primary-600"}),x.jsx("span",{className:"ml-2",children:"Mujer"})]})]})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700",children:"Edad (años)"}),x.jsx("input",{type:"number",id:"age",name:"age",value:l.age,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",min:"15",max:"100",required:!0}),c.age&&x.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.age})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700",children:"Peso (kg)"}),x.jsx("input",{type:"number",id:"weight",name:"weight",value:l.weight,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",min:"30",max:"250",step:"0.1",required:!0}),c.weight&&x.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.weight})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx("label",{htmlFor:"height",className:"block text-sm font-medium text-gray-700",children:"Altura (cm)"}),x.jsx("input",{type:"number",id:"height",name:"height",value:l.height,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",min:"120",max:"250",required:!0}),c.height&&x.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.height})]}),x.jsxs("div",{className:"space-y-2 md:col-span-2",children:[x.jsx("label",{htmlFor:"activityLevel",className:"block text-sm font-medium text-gray-700",children:"Nivel de actividad física"}),x.jsx("select",{id:"activityLevel",name:"activityLevel",value:l.activityLevel,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0,children:[{value:"1.2",label:"Sedentario (poco o ningún ejercicio)"},{value:"1.375",label:"Ligera actividad (ejercicio ligero 1-3 días/semana)"},{value:"1.55",label:"Moderada (ejercicio moderado 3-5 días/semana)"},{value:"1.725",label:"Activo (ejercicio intenso 6-7 días/semana)"},{value:"1.9",label:"Muy activo (ejercicio muy intenso o trabajo físico)"}].map((e=>x.jsx("option",{value:e.value,children:e.label},e.value)))})]}),r&&x.jsxs("div",{className:"space-y-2 md:col-span-2",children:[x.jsx("label",{htmlFor:"goal",className:"block text-sm font-medium text-gray-700",children:"Objetivo"}),x.jsxs("div",{className:"p-3 bg-gray-50 rounded-md border border-gray-200",children:[x.jsx("p",{className:"text-sm text-gray-700",children:(null==(t=r.find((e=>e.value===s)))?void 0:t.label)||"No especificado"}),x.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ajuste calórico: ",m>0?"+":"",(100*m).toFixed(0),"%"]})]})]})]}),x.jsxs("div",{className:"pt-4 flex space-x-3",children:[x.jsx("button",{type:"button",onClick:p,className:"flex-1 bg-primary-600 text-white py-2 px-4 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors",children:"Calcular Calorías"}),x.jsx("button",{type:"button",onClick:()=>h({target:{name:"calories",value:""}}),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Limpiar"})]})]}),i&&x.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Resultados"}),x.jsxs("div",{className:"space-y-2",children:[x.jsxs("p",{className:"text-sm text-gray-600",children:[x.jsx("span",{className:"font-medium",children:"TMB (Tasa Metabólica Basal):"})," ",i.bmr.toLocaleString()," kcal/día"]}),x.jsxs("p",{className:"text-sm text-gray-600",children:[x.jsx("span",{className:"font-medium",children:"TDEE (Gasto Calórico Diario):"})," ",i.tdee.toLocaleString()," kcal/día"]}),x.jsxs("p",{className:"text-lg font-semibold text-primary-700 mt-3",children:["Calorías diarias recomendadas: ",i.adjustedCalories.toLocaleString()," kcal/día",0!==i.goal&&x.jsxs("span",{className:"block text-sm font-normal text-gray-600",children:["(",i.goal>0?"+":"",i.goal,"% de ajuste por objetivo)"]})]})]})]})]})},N=({formData:a,errors:s,isLoading:r,apiError:t,goalOptions:l,preferenceOptions:n,diet:i,handleChange:o,handleSubmit:c,isValid:d})=>{const[m,u]=e.useState(!1);return x.jsx("div",{className:"bg-white min-h-screen",children:x.jsxs("div",{className:"max-w-6xl mx-auto py-8 px-4 sm:px-6 lg:px-8 w-full",children:[x.jsxs("div",{className:"max-w-3xl mx-auto text-center mb-12",children:[x.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl",children:"Generador de dietas personalizadas"}),x.jsx("p",{className:"mt-3 text-xl text-gray-500",children:"Crea un plan de alimentación adaptado a tus necesidades específicas"})]}),x.jsxs("form",{onSubmit:c,className:"space-y-8",children:[t&&x.jsx("div",{className:"mt-4 p-4 bg-accent-50 border border-accent-200 text-accent-800 rounded",children:t}),x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200",children:[x.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:"¿Cuál es tu objetivo principal?"}),x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{id:"perdida",title:"Pérdida de peso",icon:x.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 6L9 12.75l4.286-4.286a11.948 11.948 0 014.306 6.43l.776 2.898m0 0l3.182-5.511m-3.182 5.51l-5.511-3.181"})}),description:"Dieta alta en proteínas para preservar masa muscular durante el déficit calórico."},{id:"mantenimiento",title:"Mantenimiento",icon:x.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"})}),description:"Dieta equilibrada para mantener tu peso actual y tu rendimiento."},{id:"aumento",title:"Aumento muscular",icon:x.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 18L9 11.25l4.306 4.306a11.95 11.95 0 015.814-5.518l2.74-1.22m0 0l-5.94-2.281m5.94 2.28l-2.28 5.941"})}),description:"Dieta alta en carbohidratos para crecimiento muscular."}].map((e=>x.jsxs("div",{onClick:()=>o({target:{name:"goal",value:e.id}}),className:"h-full flex flex-col p-5 rounded-xl border-2 cursor-pointer transition-all "+(a.goal===e.id?"border-primary-500 bg-primary-50 ring-2 ring-primary-200 shadow-sm":"border-gray-200 hover:border-gray-300 bg-white hover:bg-gray-50"),children:[x.jsx("div",{className:"p-2 rounded-lg self-start mb-3 "+(a.goal===e.id?"bg-primary-100 text-primary-600":"bg-gray-100 text-gray-600"),children:e.icon}),x.jsx("h3",{className:"text-lg font-medium "+(a.goal===e.id?"text-primary-800":"text-gray-900"),children:e.title}),x.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e.description})]},e.id)))}),x.jsx("input",{type:"hidden",name:"goal",value:a.goal||"",required:!0}),s.goal&&x.jsx("p",{className:"mt-2 text-sm text-red-600",children:s.goal})]}),a.goal&&x.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-200",children:x.jsxs("div",{className:"space-y-6",children:[x.jsx("div",{className:"w-full",children:x.jsx("div",{className:"max-w-3xl mx-auto",children:x.jsx(f,{proteinPercentage:a.proteinPercentage,carbsPercentage:a.carbsPercentage,fatPercentage:a.fatsPercentage,calories:parseInt(a.calories)||0})})}),(null==i?void 0:i.summary)&&x.jsx("div",{className:"w-full",children:x.jsx("div",{className:"max-w-3xl mx-auto",children:x.jsx(b,{totalCalories:parseInt(a.calories)||0,totalProteins:i.summary.totalProteins,totalCarbs:i.summary.totalCarbs,totalFats:i.summary.totalFats,targetProtein:parseInt(a.proteinPercentage)||0,targetCarbs:parseInt(a.carbsPercentage)||0,targetFats:parseInt(a.fatsPercentage)||0})})})]})})]}),x.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Requerimientos básicos"}),x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"space-y-2 text-center",children:[x.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Calorías diarias"}),x.jsxs("div",{className:"relative",children:[x.jsx("input",{type:"number",name:"calories",value:a.calories||"",onChange:e=>{const s=e.target.value,r=e.target;""===s||Number(s)>=1e3&&Number(s)<=1e4?o({target:{name:"calories",value:""===s?"":Math.round(Number(s)).toString()}}):r.value=a.calories||""},onBlur:e=>{let a=Number(e.target.value);(isNaN(a)||a<1e3)&&(a=2e3),a=Math.max(1e3,Math.min(1e4,a)),e.target.value=a,o({target:{name:"calories",value:a.toString()}})},className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-center text-xl font-semibold text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"2000",min:"1000",max:"10000",step:"50",required:!0}),x.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"kcal"})]}),x.jsx("p",{className:"text-xs text-gray-500",children:x.jsx("button",{type:"button",onClick:()=>u(!m),className:"text-primary-600 hover:text-primary-800 font-medium focus:outline-none",children:m?"Ocultar calculadora":"Calcular automáticamente"})})]}),m&&x.jsx("div",{className:"mt-4 p-4 border border-gray-200 rounded-lg bg-gray-50",children:x.jsx(y,{onCalculate:e=>{console.log("handleCaloriesCalculated llamado con:",e);const a=Number(e);if(isNaN(a))return void console.error("Valor de calorías inválido recibido:",e);const s=Math.round(a);console.log("Actualizando calorías a:",s);const r=document.querySelector('input[name="calories"]');if(r){r.value=s;const e=new Event("input",{bubbles:!0});r.dispatchEvent(e)}o({target:{name:"calories",value:s.toString()}}),u(!1)},selectedGoal:a.goal,goalOptions:l})})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Comidas por día"}),x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[3,4,5,6].map((e=>x.jsxs("button",{type:"button",onClick:()=>o({target:{name:"mealsPerDay",value:e.toString()}}),className:"flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-all "+(parseInt(a.mealsPerDay)===e?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[x.jsx("span",{className:"text-base font-medium",children:e}),x.jsxs("span",{className:"text-xs text-gray-500",children:["Comida",e>1?"s":""]})]},e)))}),x.jsx("input",{type:"hidden",name:"mealsPerDay",value:a.mealsPerDay||"",required:!0}),s.mealsPerDay&&x.jsx("p",{className:"mt-1 text-xs text-red-600",children:s.mealsPerDay})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Tipo de dieta ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 w-full",children:[{id:"omnivoro",title:"Omnívoro",icon:x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-utensils-icon lucide-utensils",children:[x.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),x.jsx("path",{d:"M7 2v20"}),x.jsx("path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),description:"Incluye todo tipo de alimentos: carnes, pescados, lácteos, huevos, frutas, verduras, cereales y legumbres."},{id:"vegetariano",title:"Vegetariano",icon:x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-carrot-icon lucide-carrot",children:[x.jsx("path",{d:"M2.27 21.7s9.87-3.5 12.73-6.36a4.5 4.5 0 0 0-6.36-6.37C5.77 11.84 2.27 21.7 2.27 21.7zM8.64 14l-2.05-2.04M15.34 15l-2.46-2.46"}),x.jsx("path",{d:"M22 9s-1.33-2-3.5-2C16.86 7 15 9 15 9s1.33 2 3.5 2S22 9 22 9z"}),x.jsx("path",{d:"M15 2s-2 1.33-2 3.5S15 9 15 9s2-1.84 2-3.5C17 3.33 15 2 15 2z"})]}),description:"Incluye lácteos, huevos, frutas, verduras, cereales y legumbres, sin carnes ni pescados."},{id:"vegano",title:"Vegano",icon:x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-leaf-icon lucide-leaf",children:[x.jsx("path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"}),x.jsx("path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"})]}),description:"Solo alimentos de origen vegetal: frutas, verduras, cereales, legumbres, frutos secos y semillas."},{id:"sin_gluten",title:"Sin gluten",icon:x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-wheat-off-icon lucide-wheat-off",children:[x.jsx("path",{d:"m2 22 10-10"}),x.jsx("path",{d:"m16 8-1.17 1.17"}),x.jsx("path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"}),x.jsx("path",{d:"m8 8-.53.53a3.5 3.5 0 0 0 0 4.94L9 15l1.53-1.53c.55-.55.88-1.25.98-1.97"}),x.jsx("path",{d:"M10.91 5.26c.15-.26.34-.51.56-.73L13 3l1.53 1.53a3.5 3.5 0 0 1 .28 4.62"}),x.jsx("path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z"}),x.jsx("path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z"}),x.jsx("path",{d:"m16 16-.53.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.49 3.49 0 0 1 1.97-.98"}),x.jsx("path",{d:"M18.74 13.09c.26-.15.51-.34.73-.56L21 11l-1.53-1.53a3.5 3.5 0 0 0-4.62-.28"}),x.jsx("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]}),description:"Elimina el trigo, cebada, centeno y sus derivados. Incluye alternativas sin gluten."},{id:"sin_lactosa",title:"Sin lactosa",icon:x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-milk-off-icon lucide-milk-off",children:[x.jsx("path",{d:"M8 2h8"}),x.jsx("path",{d:"M9 2v1.343M15 2v2.789a4 4 0 0 0 .672 2.219l.656.984a4 4 0 0 1 .672 2.22v1.131M7.8 7.8l-.128.192A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-3"}),x.jsx("path",{d:"M7 15a6.47 6.47 0 0 1 5 0 6.472 6.472 0 0 0 3.435.435"}),x.jsx("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]}),description:"Excluye la leche y derivados lácteos que contengan lactosa, incluyendo alternativas vegetales."}].map((e=>x.jsxs("div",{onClick:()=>o({target:{name:"preferences",value:e.id}}),className:"h-full flex flex-col p-4 rounded-xl border-2 cursor-pointer transition-all "+(a.preferences===e.id?"border-primary-500 bg-primary-50 ring-2 ring-primary-200 shadow-sm":"border-gray-200 hover:border-gray-300 bg-white hover:bg-gray-50"),children:[x.jsxs("div",{className:"flex items-start mb-2",children:[x.jsx("div",{className:"p-1.5 rounded-lg mr-3 flex-shrink-0 w-8 h-8 flex items-center justify-center "+(a.preferences===e.id?"bg-primary-100 text-primary-600":"bg-gray-100 text-gray-600"),children:x.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:e.icon})}),x.jsx("span",{className:"font-medium text-gray-900 leading-tight",children:e.title})]}),x.jsx("p",{className:"text-xs text-gray-500 mt-2",children:e.description})]},e.id)))}),x.jsx("input",{type:"hidden",name:"preferences",value:a.preferences||"",required:!0}),s.preferences&&x.jsx("p",{className:"mt-2 text-sm text-red-600",children:s.preferences})]})]})]}),x.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200",children:[x.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:"Alergias e intolerancias"}),x.jsx("div",{className:"grid grid-cols-1 gap-6",children:x.jsx(g,{label:"Alergias o intolerancias alimentarias (opcional)",name:"allergies",type:"text",value:a.allergies||"",onChange:e=>o(e),error:s.allergies,placeholder:"Ej: Cacahuetes, mariscos, lactosa, gluten...",helpText:"Especifica cualquier alergia o intolerancia que tengas para que podamos adaptar tu plan."})})]}),x.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200",children:[x.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:"Preferencias alimentarias"}),x.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[x.jsx(g,{label:"Alimentos que no te gustan (opcional)",name:"forbiddenFoods",type:"text",value:a.forbiddenFoods||"",onChange:e=>o(e),error:s.forbiddenFoods,placeholder:"Ej: Brócoli, pescado azul, champiñones...",helpText:"Evitaremos incluir estos alimentos en tu plan."}),x.jsx(g,{label:"Tus comidas favoritas (opcional)",name:"favoriteFoods",type:"text",value:a.favoriteFoods||"",onChange:e=>o(e),error:s.favoriteFoods,placeholder:"Ej: Pasta, pollo a la plancha, ensalada César...",helpText:"Incluiremos estos alimentos en tu plan cuando sea posible."})]})]}),x.jsx("div",{className:"pt-2",children:x.jsx("button",{type:"submit",disabled:r||!d,className:"w-full flex justify-center py-4 px-6 border border-transparent rounded-xl shadow-sm text-base font-medium text-white "+(r||!d?"bg-primary-400 cursor-not-allowed":"bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200"),children:r?x.jsxs(x.Fragment,{children:[x.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[x.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),x.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generando tu dieta..."]}):"Generar mi plan de dieta personalizado"})})]})]})})},w={proteins:x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6",children:x.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.25 6.087c0-.355.186-.676.401-.959.221-.29.349-.634.349-1.003 0-1.036-1.007-1.875-2.25-1.875s-2.25.84-2.25 1.875c0 .369.128.713.349 1.003.215.283.401.604.401.959v0a.64.64 0 0 1-.657.643 48.39 48.39 0 0 1-4.163-.3c.186 1.613.293 3.25.315 4.907a.656.656 0 0 1-.658.663v0c-.355 0-.676-.186-.959-.401a1.647 1.647 0 0 0-1.003-.349c-1.036 0-1.875 1.007-1.875 2.25s.84 2.25 1.875 2.25c.369 0 .713-.128 1.003-.349.283-.215.604-.401.959-.401v0c.31 0 .555.26.532.57a48.039 48.039 0 0 1-.642 5.056c1.518.19 3.058.309 4.616.354a.64.64 0 0 0 .657-.643v0c0-.355-.186-.676-.401-.959a1.647 1.647 0 0 1-.349-1.003c0-1.035 1.008-1.875 2.25-1.875 1.243 0 2.25.84 2.25 1.875 0 .369-.128.713-.349 1.003-.215.283-.4.604-.4.959v0c0 .333.277.599.61.58a48.1 48.1 0 0 0 5.427-.63 48.05 48.05 0 0 0 .582-4.717.532.532 0 0 0-.533-.57v0c-.355 0-.676.186-.959.401-.29.221-.634.349-1.003.349-1.035 0-1.875-1.007-1.875-2.25s.84-2.25 1.875-2.25c.37 0 .713.128 1.003.349.283.215.604.401.96.401v0a.656.656 0 0 0 .658-.663 48.422 48.422 0 0 0-.37-5.36c-1.886.342-3.81.574-5.766.689a.578.578 0 0 1-.61-.58v0Z"})}),carbs:x.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),fats:x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6",children:x.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"})}),calorias:x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6",children:[x.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z"}),x.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z"})]})},k=({meal:e})=>{var a;const s=a=>e.macros?"string"==typeof e.macros[a]?e.macros[a]:`${e.macros[a]}-${e.macros[a]}`:"0-0",r={proteins:s("proteins"),carbs:s("carbs"),fats:s("fats"),calories:(null==(a=e.calories)?void 0:a.includes("Aprox."))?e.calories.replace("Aprox.","").trim():e.calories||"0-0 kcal"};return x.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-6 border border-gray-100 hover:shadow-xl transition-all duration-300",children:[x.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4",children:[x.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:e.name}),x.jsxs("div",{className:"flex flex-wrap gap-3 mt-2 sm:mt-0",children:[x.jsxs("div",{className:"flex items-center space-x-1 bg-red-50 px-2 py-1 rounded-full",children:[x.jsx("span",{className:"text-red-500",children:w.proteins}),x.jsx("span",{className:"text-xs font-medium text-red-700",children:r.proteins})]}),x.jsxs("div",{className:"flex items-center space-x-1 bg-orange-50 px-2 py-1 rounded-full",children:[x.jsx("span",{className:"text-orange-500",children:w.carbs}),x.jsx("span",{className:"text-xs font-medium text-orange-700",children:r.carbs})]}),x.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-50 px-2 py-1 rounded-full",children:[x.jsx("span",{className:"text-yellow-500",children:w.fats}),x.jsx("span",{className:"text-xs font-medium text-yellow-700",children:r.fats})]}),x.jsxs("div",{className:"flex items-center space-x-1 bg-green-50 px-2 py-1 rounded-full",children:[x.jsx("span",{className:"text-green-500",children:w.calorias}),x.jsx("span",{className:"text-xs font-medium text-green-700",children:r.calories.includes("kcal")?r.calories:`${r.calories} kcal`})]})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"w-full",children:[x.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-2",children:"Ingredientes"}),e.ingredients&&e.ingredients.length>0?x.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:x.jsx("table",{className:"min-w-full divide-y divide-gray-200",children:x.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.ingredients?Array.isArray(e.ingredients)?e.ingredients.map(((e,a)=>x.jsxs("tr",{className:a%2==0?"bg-white":"bg-gray-50",children:[x.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),x.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500 text-right",children:e.amount})]},a))):e.ingredients.split("\n").map(((e,a)=>{const s=e.split(":");if(s.length>=2){const e=s[0].trim(),r=s.slice(1).join(":").trim();return x.jsxs("tr",{className:a%2==0?"bg-white":"bg-gray-50",children:[x.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:e}),x.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500 text-right",children:r})]},a)}return null})):null})})}):x.jsx("p",{className:"text-gray-500 text-sm",children:"No se especificaron ingredientes"})]}),e.preparation&&x.jsxs("div",{className:"mt-4",children:[x.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-2",children:"Preparación"}),x.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:x.jsx("p",{className:"whitespace-pre-line text-gray-700",children:e.preparation})})]}),e.notes&&x.jsxs("div",{className:"mt-4",children:[x.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-2",children:"Notas"}),x.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-100",children:x.jsx("p",{className:"whitespace-pre-line text-yellow-700",children:e.notes})})]})]})]})},C=({formData:e,goalOptions:a,preferenceOptions:s})=>{var r,t;return x.jsxs("div",{className:"w-full",children:[x.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Resumen de tu dieta"}),x.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[x.jsxs("div",{className:"bg-neutral-50 p-3 rounded-lg border border-neutral-100",children:[x.jsx("h3",{className:"text-sm font-semibold text-neutral-600 mb-1",children:"Objetivo"}),x.jsx("p",{className:"text-base font-medium text-neutral-800",children:e.goal?(null==(r=a.find((a=>a.value===e.goal)))?void 0:r.label)||e.goal:"No especificado"})]}),x.jsxs("div",{className:"bg-neutral-50 p-3 rounded-lg border border-neutral-100",children:[x.jsx("h3",{className:"text-sm font-semibold text-neutral-600 mb-1",children:"Calorías totales"}),x.jsxs("p",{className:"text-xl font-bold text-primary-600",children:[e.calories," kcal"]})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[x.jsxs("div",{className:"bg-neutral-50 p-3 rounded-lg border border-neutral-100",children:[x.jsx("h3",{className:"text-xs font-semibold text-neutral-500 mb-1",children:"Comidas/día"}),x.jsx("p",{className:"text-sm text-neutral-800",children:e.mealsPerDay})]}),x.jsxs("div",{className:"bg-neutral-50 p-3 rounded-lg border border-neutral-100",children:[x.jsx("h3",{className:"text-xs font-semibold text-neutral-500 mb-1",children:"Preferencias"}),x.jsx("p",{className:"text-sm text-neutral-800",children:e.preferences?(null==(t=s.find((a=>a.value===e.preferences)))?void 0:t.label)||e.preferences:"No especificadas"})]})]})]})},P=({formData:e,goalOptions:a,preferenceOptions:s,diet:r,onNewDiet:t})=>x.jsx("div",{className:"w-full",children:x.jsx("div",{className:"bg-white rounded-lg",children:x.jsxs("div",{className:"w-full",children:[x.jsx(C,{formData:e,goalOptions:a,preferenceOptions:s}),x.jsxs("div",{className:"mt-6",children:[x.jsx("h2",{className:"text-xl font-bold mb-6 text-center",children:"Comidas"}),x.jsx("div",{className:"grid grid-cols-1 gap-4",children:r.meals.map(((e,a)=>x.jsx("div",{className:"border border-neutral-100 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-200",children:x.jsx(k,{meal:e})},a)))})]}),x.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:x.jsx("button",{onClick:t,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200",children:"Generar nueva dieta"})})]})})}),M=[{value:"perdida",label:"Pérdida de peso"},{value:"mantenimiento",label:"Mantenimiento"},{value:"aumento",label:"Aumento de masa muscular"}],S={perdida:"perdida",mantenimiento:"mantenimiento",aumento:"aumento"},L=[{value:"omnivoro",label:"Omnívoro"},{value:"vegetariano",label:"Vegetariano"},{value:"vegano",label:"Vegano"},{value:"sin_gluten",label:"Sin gluten"},{value:"sin_lactosa",label:"Sin lactosa"}],E={perdida:{protein:40,carbs:35,fats:25},mantenimiento:{protein:30,carbs:40,fats:30},aumento:{protein:25,carbs:50,fats:25}};function O(){const[a,s]=e.useState({calories:"",mealsPerDay:"3",allergies:"",preferences:"",forbiddenFoods:"",goal:"",favoriteFoods:"",proteinPercentage:30,carbsPercentage:40,fatsPercentage:30}),[r,t]=e.useState({}),[l,n]=e.useState(!1),[i,o]=e.useState(""),[c,d]=e.useState(null),[m,u]=e.useState(!0),[p,g]=e.useState(!0),f=e=>({proteins:.3*e/4,carbs:.4*e/4,fats:.3*e/9});return x.jsx("div",{className:"min-h-screen bg-neutral-50 p-3 sm:p-4",children:x.jsx("div",{className:"w-full max-w-7xl mx-auto",children:x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-400 to-primary-600 shadow-lg transform "+(m?"sm:rounded-xl":"sm:rounded-2xl")}),x.jsx("div",{className:`relative bg-white ${m?"shadow-md rounded-lg":"shadow-lg rounded-xl"} p-4 ${m?"":"sm:p-5"}`,style:{minHeight:"calc(100vh - 2rem)"},children:l?x.jsx("div",{className:"flex items-center justify-center h-64",children:x.jsx(h,{})}):m?x.jsx(N,{formData:a,errors:r,isLoading:l,apiError:i,goalOptions:M,preferenceOptions:L,diet:c,handleChange:e=>{const{name:a,value:l}=e.target;if(console.log(`[handleChange] Campo cambiado - ${a}:`,l,"Tipo:",typeof l),"goal"===a&&l){const e=E[S[l]||"mantenimiento"];s((s=>{const r={...s,[a]:l,proteinPercentage:e.protein.toString(),carbsPercentage:e.carbs.toString(),fatsPercentage:e.fats.toString()};return console.log("[handleChange] Nuevo estado (goal):",r),r}))}else if("calories"===a){const e=""===l?"":l.replace(/\D/g,"");console.log("[handleChange] Procesando calorías. Valor original:",l,"Valor procesado:",e),s((s=>{const r={...s,[a]:e};return console.log("[handleChange] Nuevo estado (calorías):",r),r}))}else s((e=>{const s={...e,[a]:l};return console.log("[handleChange] Nuevo estado (otro campo):",s),s}));r[a]&&t((e=>({...e,[a]:null})))},handleSubmit:async e=>{e.preventDefault();if((()=>{const e={};return(!a.calories||isNaN(a.calories)||a.calories<1e3||a.calories>5e3)&&(e.calories="Por favor, introduce un número válido entre 1000 y 5000 kcal"),(!a.mealsPerDay||isNaN(a.mealsPerDay)||a.mealsPerDay<1||a.mealsPerDay>6)&&(e.mealsPerDay="Por favor, introduce un número entre 1 y 6"),a.goal||(e.goal="Por favor, selecciona un objetivo"),a.preferences||(e.preferences="Por favor, selecciona tus preferencias alimentarias"),t(e),0===Object.keys(e).length})()){n(!0),o(null);try{const e=parseInt(a.calories,10)||0,t=parseInt(a.proteinPercentage,10)||30,l=parseInt(a.carbsPercentage,10)||40,n=t+l+(parseInt(a.fatsPercentage,10)||30),i=Math.round(t/n*100),o=Math.round(l/n*100),c=100-i-o,m=Math.round(e*(i/100)/4),x=Math.round(e*(o/100)/4),p=Math.round(e*(c/100)/9),h={...a,calories:e,mealsPerDay:parseInt(a.mealsPerDay,10)||3,macros:{protein:m,carbs:x,fats:p,proteinPercentage:i,carbsPercentage:o,fatsPercentage:c}};let g,b;console.log("Enviando solicitud a /api/ con datos:",JSON.stringify(h,null,2));try{console.log("Enviando solicitud a la API..."),g=await fetch("/api/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(h)}),console.log("Respuesta HTTP recibida. Status:",g.status);const e=await g.text();console.log("Contenido de la respuesta (texto):",e);try{b=e?JSON.parse(e):{},console.log("Respuesta del servidor (parseada):",JSON.stringify(b,null,2))}catch(s){throw console.error("Error al analizar la respuesta JSON:",s),new Error("La respuesta del servidor no es un JSON válido.")}if(!g.ok)throw new Error(b.error||`Error del servidor: ${g.status} ${g.statusText}`);if(!b)throw new Error("El servidor no devolvió ningún dato.")}catch(r){throw console.error("Error en la petición:",{message:r.message,status:null==g?void 0:g.status,response:b||"No hay datos de respuesta",stack:r.stack}),r}if(b.success&&b.plan&&b.plan.meals){const e=b.plan.meals.map((e=>{const a=f(e.calories||0);return{...e,proteins:e.proteins||Math.round(a.proteins),carbs:e.carbs||Math.round(a.carbs),fats:e.fats||Math.round(a.fats)}})),a=e.reduce(((e,a)=>({proteins:e.proteins+(a.proteins||0),carbs:e.carbs+(a.carbs||0),fats:e.fats+(a.fats||0)})),{proteins:0,carbs:0,fats:0});b.plan.meals=e,b.plan.total_macros={proteins:Math.round(a.proteins),carbs:Math.round(a.carbs),fats:Math.round(a.fats)}}d(b.success?b.plan:null),u(!1)}catch(l){console.error("Error en handleSubmit:",{message:l.message,stack:l.stack,response:l.response?await l.response.text().catch((()=>"No se pudo leer la respuesta")):"No hay respuesta"}),o(l.message||"Error al procesar la respuesta del servidor")}finally{n(!1)}}else console.log("Validación del formulario fallida")},isValid:p}):x.jsx(P,{formData:a,goalOptions:M,preferenceOptions:L,diet:c,onNewDiet:()=>{u(!0),d(null)}})})]})})})}const D=document.getElementById("root");if(!D)throw new Error("No se encontró el elemento con id 'root'");u(D).render(x.jsx(s.StrictMode,{children:x.jsx(O,{})}));
